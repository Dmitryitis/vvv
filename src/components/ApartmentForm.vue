<template>
  <div class="flex-1 bg-white rounded-2xl shadow-sm border border-gray-100 p-8">
    <h2 class="text-2xl font-semibold text-gray-900 mb-8">–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–≤–∞—Ä—Ç–∏—Ä—ã</h2>
    <form @submit.prevent="$emit('calculate')" class="space-y-8">
      
      <!-- –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã -->
      <div class="space-y-4">
        <h3 class="text-lg font-medium text-gray-900">–û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã</h3>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
          <div>
            <label class="block text-sm font-medium text-gray-600 mb-2">–û–±—â–∞—è –ø–ª–æ—â–∞–¥—å (–º¬≤) *</label>
            <input v-model.number="apartmentData.totalArea" 
                   type="number" 
                   required 
                   placeholder="45"
                   class="w-full px-4 py-3 bg-gray-50 border-0 rounded-xl text-gray-900 placeholder-gray-400 focus:bg-white focus:ring-2 focus:ring-blue-500 transition-all">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-600 mb-2">–ñ–∏–ª–∞—è –ø–ª–æ—â–∞–¥—å (–º¬≤) *</label>
            <input v-model.number="apartmentData.livingArea" 
                   type="number" 
                   required 
                   placeholder="30"
                   class="w-full px-4 py-3 bg-gray-50 border-0 rounded-xl text-gray-900 placeholder-gray-400 focus:bg-white focus:ring-2 focus:ring-blue-500 transition-all">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-600 mb-2">–≠—Ç–∞–∂ *</label>
            <input v-model.number="apartmentData.floor" 
                   type="number" 
                   required 
                   placeholder="5"
                   class="w-full px-4 py-3 bg-gray-50 border-0 rounded-xl text-gray-900 placeholder-gray-400 focus:bg-white focus:ring-2 focus:ring-blue-500 transition-all">
          </div>
        </div>
      </div>

      <!-- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
      <div class="space-y-4">
        <h3 class="text-lg font-medium text-gray-900">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
          <div>
            <label class="block text-sm font-medium text-gray-600 mb-2">–ü–ª–æ—â–∞–¥—å –∫—É—Ö–Ω–∏ (–º¬≤)</label>
            <input v-model.number="apartmentData.kitchenArea" 
                   type="number" 
                   placeholder="12"
                   class="w-full px-4 py-3 bg-gray-50 border-0 rounded-xl text-gray-900 placeholder-gray-400 focus:bg-white focus:ring-2 focus:ring-blue-500 transition-all">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-600 mb-2">–≠—Ç–∞–∂–Ω–æ—Å—Ç—å –¥–æ–º–∞</label>
            <input v-model.number="apartmentData.totalFloors" 
                   type="number" 
                   placeholder="17"
                   class="w-full px-4 py-3 bg-gray-50 border-0 rounded-xl text-gray-900 placeholder-gray-400 focus:bg-white focus:ring-2 focus:ring-blue-500 transition-all">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-600 mb-2">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–º–Ω–∞—Ç</label>
            <input v-model.number="apartmentData.rooms" 
                   type="number" 
                   placeholder="2"
                   class="w-full px-4 py-3 bg-gray-50 border-0 rounded-xl text-gray-900 placeholder-gray-400 focus:bg-white focus:ring-2 focus:ring-blue-500 transition-all">
          </div>
        </div>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-medium text-gray-600 mb-2">–ì–æ–¥ –ø–æ—Å—Ç—Ä–æ–π–∫–∏</label>
            <input v-model.number="apartmentData.yearBuilt" 
                   type="number" 
                   min="1900" 
                   max="2025" 
                   placeholder="2018"
                   class="w-full px-4 py-3 bg-gray-50 border-0 rounded-xl text-gray-900 placeholder-gray-400 focus:bg-white focus:ring-2 focus:ring-blue-500 transition-all">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-600 mb-2">–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ –º–µ—Ç—Ä–æ (–º–∏–Ω)</label>
            <input v-model.number="apartmentData.metroDistance" 
                   type="number" 
                   min="1" 
                   max="60" 
                   placeholder="7"
                   class="w-full px-4 py-3 bg-gray-50 border-0 rounded-xl text-gray-900 placeholder-gray-400 focus:bg-white focus:ring-2 focus:ring-blue-500 transition-all">
          </div>
        </div>
      </div>

      <!-- –°–µ–ª–µ–∫—Ç–æ—Ä—ã -->
      <div class="space-y-6">
        <!-- –¢–∏–ø –¥–æ–º–∞ -->
        <div class="space-y-4">
          <h3 class="text-lg font-medium text-gray-900">–¢–∏–ø –¥–æ–º–∞</h3>
          <div class="flex flex-wrap gap-3">
            <button v-for="(type, index) in buildingTypes" 
                    :key="index"
                    type="button"
                    @click="apartmentData.buildingType = index + 1"
                    :class="apartmentData.buildingType === index + 1 ? 
                            'bg-black text-white shadow-md' : 
                            'bg-gray-50 text-gray-700 hover:bg-gray-100'"
                    class="px-5 py-3 rounded-xl text-sm font-medium transition-all duration-200 border-0">
              {{ type }}
            </button>
          </div>
        </div>

        <!-- –ö–∞—á–µ—Å—Ç–≤–æ —Ä–µ–º–æ–Ω—Ç–∞ -->
        <div class="space-y-4">
          <h3 class="text-lg font-medium text-gray-900">–ö–∞—á–µ—Å—Ç–≤–æ —Ä–µ–º–æ–Ω—Ç–∞</h3>
          <div class="flex flex-wrap gap-3">
            <button v-for="(renovation, index) in renovationTypes" 
                    :key="index"
                    type="button"
                    @click="apartmentData.renovation = index + 1"
                    :class="apartmentData.renovation === index + 1 ? 
                            'bg-black text-white shadow-md' : 
                            'bg-gray-50 text-gray-700 hover:bg-gray-100'"
                    class="px-5 py-3 rounded-xl text-sm font-medium transition-all duration-200 border-0">
              {{ renovation }}
            </button>
          </div>
        </div>

        <!-- –¢–∏–ø –æ–±—ä–µ–∫—Ç–∞ -->
        <div class="space-y-4">
          <h3 class="text-lg font-medium text-gray-900">–¢–∏–ø –æ–±—ä–µ–∫—Ç–∞</h3>
          <div class="flex flex-wrap gap-3">
            <button v-for="(objType, index) in objectTypes" 
                    :key="index"
                    type="button"
                    @click="apartmentData.objectType = index + 1"
                    :class="apartmentData.objectType === index + 1 ? 
                            'bg-black text-white shadow-md' : 
                            'bg-gray-50 text-gray-700 hover:bg-gray-100'"
                    class="px-5 py-3 rounded-xl text-sm font-medium transition-all duration-200 border-0">
              {{ objType }}
            </button>
          </div>
        </div>

        <!-- –í–∏–¥ –∏–∑ –æ–∫–æ–Ω -->
        <div class="space-y-4">
          <h3 class="text-lg font-medium text-gray-900">–í–∏–¥ –∏–∑ –æ–∫–æ–Ω</h3>
          <div class="flex flex-wrap gap-3">
            <button v-for="(view, index) in windowViews" 
                    :key="index"
                    type="button"
                    @click="apartmentData.windowView = index + 1"
                    :class="apartmentData.windowView === index + 1 ? 
                            'bg-black text-white shadow-md' : 
                            'bg-gray-50 text-gray-700 hover:bg-gray-100'"
                    class="px-5 py-3 rounded-xl text-sm font-medium transition-all duration-200 border-0">
              {{ view }}
            </button>
          </div>
        </div>

        <!-- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ -->
        <div class="space-y-4">
          <h3 class="text-lg font-medium text-gray-900">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ</h3>
          <div class="flex flex-wrap gap-3">
            <button type="button"
                    @click="apartmentData.balcony = !apartmentData.balcony"
                    :class="apartmentData.balcony ? 
                            'bg-black text-white shadow-md' : 
                            'bg-gray-50 text-gray-700 hover:bg-gray-100'"
                    class="px-5 py-3 rounded-xl text-sm font-medium transition-all duration-200 border-0 flex items-center gap-2">
              <span class="text-lg">üè†</span>
              –ë–∞–ª–∫–æ–Ω
            </button>
            <button type="button"
                    @click="apartmentData.parking = !apartmentData.parking"
                    :class="apartmentData.parking ? 
                            'bg-black text-white shadow-md' : 
                            'bg-gray-50 text-gray-700 hover:bg-gray-100'"
                    class="px-5 py-3 rounded-xl text-sm font-medium transition-all duration-200 border-0 flex items-center gap-2">
              <span class="text-lg">üöó</span>
              –ü–∞—Ä–∫–æ–≤–∫–∞
            </button>
            <button type="button"
                    @click="apartmentData.garbageChute = !apartmentData.garbageChute"
                    :class="apartmentData.garbageChute ? 
                            'bg-black text-white shadow-md' : 
                            'bg-gray-50 text-gray-700 hover:bg-gray-100'"
                    class="px-5 py-3 rounded-xl text-sm font-medium transition-all duration-200 border-0 flex items-center gap-2">
              <span class="text-lg">üóëÔ∏è</span>
              –ú—É—Å–æ—Ä–æ–ø—Ä–æ–≤–æ–¥
            </button>
          </div>
        </div>
      </div>

      <!-- –ö–Ω–æ–ø–∫–∏ -->
      <div class="pt-4 space-y-3">
        <button type="submit" 
                :disabled="!canCalculate || isCalculating"
                :class="canCalculate && !isCalculating ? 
                    'bg-black hover:bg-gray-800' : 
                    'bg-gray-400 cursor-not-allowed'"
                class="w-full text-white font-semibold py-4 px-6 rounded-lg transition-colors duration-200 text-lg">
          <span v-if="isCalculating" class="flex items-center justify-center">
            <svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
              <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
              <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
            </svg>
            –†–∞—Å—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏...
          </span>
          <span v-else>–†–∞—Å—Å—á–∏—Ç–∞—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å</span>
        </button>
        
        <button type="button" 
                @click="$emit('clearForm')"
                class="w-full bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium py-3 px-6 rounded-lg transition-colors duration-200">
          –û—á–∏—Å—Ç–∏—Ç—å —Ñ–æ—Ä–º—É
        </button>
      </div>

      <p class="text-xs text-gray-500 text-center">
        * –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞
      </p>
    </form>
  </div>
</template>

<script setup>
import { computed } from 'vue'

const props = defineProps({
  apartmentData: Object,
  isCalculating: Boolean,
  buildingTypes: Array,
  renovationTypes: Array,
  objectTypes: Array,
  windowViews: Array
})

const emit = defineEmits(['calculate', 'clearForm'])

const canCalculate = computed(() => {
  return props.apartmentData.totalArea && 
         props.apartmentData.livingArea && 
         props.apartmentData.floor
})
</script>